<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>main.m Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>main.m</h1>  </div>
</div>
<div class="contents">
<a href="main_8m.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<a name="l00002"></a>00002 %! @mainpage CentralSlice
<a name="l00003"></a>00003 % CT Image Reconstruction <span class="keyword">using</span> Central Slice Theorem
<a name="l00004"></a>00004 % 
<a name="l00005"></a>00005 % Refer to the project homepage http:<span class="comment">//code.google.com/p/centralslice/</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 %! @file
<a name="l00008"></a>00008 % Main process of the simulation.
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 %! @callgraph
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 %! @example start_simulation.m
<a name="l00013"></a>00013 % This is an example of how to use <span class="keyword">this</span> simulation script.
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<a name="l00016"></a>00016 %! Main process of the simulation.
<a name="l00017"></a>00017 % This script generates a radon projection image from a selected phantom.
<a name="l00018"></a>00018 % Then 1D Fourier transform is applied to each projection angle. The result is then interpolated onto the cartesian plane according to Central slice theorem. Lastly inverse 2D Fourier transform is applied to reproduce the image.
<a name="l00019"></a>00019 % @param <a class="code" href="start__simulation_8m.html#a46ed71401dc6fcbf347aeeb51266e577" title="Shape of the phantom.">shape</a> <a class="code" href="start__simulation_8m.html#a46ed71401dc6fcbf347aeeb51266e577" title="Shape of the phantom.">shape</a> of the phantom
<a name="l00020"></a>00020 % @param <a class="code" href="start__simulation_8m.html#ac14637880ca5538e12cb721543f1e421" title="Size of the phantom.">N</a> mininium size of the phantom image (in pixels)
<a name="l00021"></a>00021 % @param <a class="code" href="start__simulation_8m.html#ae377565157953437dddcdba3712d58d9" title="Signal to noise ratio.">SNR</a> Signal to Noise Ratio
<a name="l00022"></a>00022 % @<a class="code" href="start__simulation_8m.html#a05361aac9f79166a17c58ff1eeebbf3f" title="Debug the program.">DEBUG</a> <a class="code" href="start__simulation_8m.html#a05361aac9f79166a17c58ff1eeebbf3f" title="Debug the program.">DEBUG</a> mode. If <span class="keyword">set</span> to 1, many more figure are printed out <span class="keywordflow">for</span> debugging process.
<a name="l00023"></a>00023 function <a class="code" href="main_8m.html#a453de8d450dd0d46c3e3bed423301dfa" title="Main process of the simulation.">main</a>(<a class="code" href="start__simulation_8m.html#a46ed71401dc6fcbf347aeeb51266e577" title="Shape of the phantom.">shape</a>,<a class="code" href="start__simulation_8m.html#ac14637880ca5538e12cb721543f1e421" title="Size of the phantom.">N</a>,<a class="code" href="start__simulation_8m.html#ae377565157953437dddcdba3712d58d9" title="Signal to noise ratio.">SNR</a>,<a class="code" href="start__simulation_8m.html#a05361aac9f79166a17c58ff1eeebbf3f" title="Debug the program.">DEBUG</a>)
<a name="l00024"></a>00024 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<a name="l00025"></a>00025 %% MAKE A PHANTOM AND APPLY RADON TRANSFROMATION
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 Phantom = <a class="code" href="make__phantom_8m.html#a331e43928fb28a90299da16351a619e6" title="Construct a matrix of a selected phantom.">make_phantom</a>(<a class="code" href="start__simulation_8m.html#a46ed71401dc6fcbf347aeeb51266e577" title="Shape of the phantom.">shape</a>,floor(<a class="code" href="start__simulation_8m.html#ac14637880ca5538e12cb721543f1e421" title="Size of the phantom.">N</a>/sqrt(2))); % Make a phantom.
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 axis_xy = linspace(-<a class="code" href="start__simulation_8m.html#ac14637880ca5538e12cb721543f1e421" title="Size of the phantom.">N</a>/2,<a class="code" href="start__simulation_8m.html#ac14637880ca5538e12cb721543f1e421" title="Size of the phantom.">N</a>/2,<a class="code" href="start__simulation_8m.html#ac14637880ca5538e12cb721543f1e421" title="Size of the phantom.">N</a>);
<a name="l00030"></a>00030 <a class="code" href="save__image_8m.html#aee6f9621b6888de2610a5cbc82b113e5" title="Save the gray-scale representation of the image.">save_image</a>(axis_xy,axis_xy,Phantom,...
<a name="l00031"></a>00031         <span class="stringliteral">&#39;Phantom&#39;</span>,<span class="charliteral">&#39;x&#39;</span>,<span class="charliteral">&#39;y&#39;</span>);             % Save the phantom image
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="main_8m.html#a453de8d450dd0d46c3e3bed423301dfa">00033</a> % Angles <span class="keywordflow">for</span> Radon Projection.
<a name="l00034"></a>00034 % It should be from 0deg to 180deg. The last angular sample normally is  smaller than 180deg.
<a name="l00035"></a>00035 THETA = linspace(0,180-1/2,180*2);
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 Radon = radon(Phantom,THETA);           % Apply Radon transform.
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 Radon = <a class="code" href="add__noise_8m.html#abbd309950ef9955b6474885e916a6640" title="Add noise to the image.">add_noise</a>(Radon,<a class="code" href="start__simulation_8m.html#ae377565157953437dddcdba3712d58d9" title="Signal to noise ratio.">SNR</a>);           % Add noise to the image
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 %% Zeropadding: expand the matrix to power of 2 before doing FFT
<a name="l00042"></a>00042 [size_s size_theta] = size(Radon);
<a name="l00043"></a>00043 next_power_of_2 = 2^ceil(log2(size_s));
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 size_zeropad = next_power_of_2 - size_s;
<a name="l00046"></a>00046 zeropad = zeros(floor(size_zeropad/2),size_theta);
<a name="l00047"></a>00047 Radon = vertcat(zeropad,Radon,zeropad);
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="keywordflow">if</span>(size_zeropad &amp; 2)    %<span class="keywordflow">if</span> size of zeropad is an odd number, add one more row of zeropad to the bottom.
<a name="l00050"></a>00050 Radon = vertcat(Radon,zeros(1,size_theta));
<a name="l00051"></a>00051 end
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 axis_s = linspace(-next_power_of_2/2,next_power_of_2/2,next_power_of_2);
<a name="l00054"></a>00054 <a class="code" href="save__image_8m.html#aee6f9621b6888de2610a5cbc82b113e5" title="Save the gray-scale representation of the image.">save_image</a>(THETA,axis_s,Radon,...
<a name="l00055"></a>00055         <span class="stringliteral">&#39;Radon Projection&#39;</span>,<span class="charliteral">&#39;s&#39;</span>,<span class="stringliteral">&#39;theta&#39;</span>);        % Save the radon image
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<a name="l00058"></a>00058 %% 1D FOURIER TRANSFORM
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 Fourier_Radon = fft(Radon);             % Apply FFT to each column of the radon image
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 % Label the omega_s,theta axises
<a name="l00063"></a>00063 size_omega_s = size(Fourier_Radon,1);
<a name="l00064"></a>00064 axis_omega_s = [0:(size_omega_s/2-1)  (-size_omega_s/2):-1] * 2*pi;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="keywordflow">if</span>(<a class="code" href="start__simulation_8m.html#a05361aac9f79166a17c58ff1eeebbf3f" title="Debug the program.">DEBUG</a>)
<a name="l00067"></a>00067 <a class="code" href="save__image_8m.html#aee6f9621b6888de2610a5cbc82b113e5" title="Save the gray-scale representation of the image.">save_image</a>(THETA, fftshift(axis_omega_s), real(fftshift(Fourier_Radon,1)),...
<a name="l00068"></a>00068         <span class="stringliteral">&#39;Fourier transform of Radon Space, Real Part&#39;</span>,...
<a name="l00069"></a>00069         <span class="stringliteral">&#39;theta&#39;</span>,<span class="stringliteral">&#39;omega_s&#39;</span>);     % Save the radon image (real part)
<a name="l00070"></a>00070 <a class="code" href="save__image_8m.html#aee6f9621b6888de2610a5cbc82b113e5" title="Save the gray-scale representation of the image.">save_image</a>(THETA, fftshift(axis_omega_s), imag(fftshift(Fourier_Radon,1)),...
<a name="l00071"></a>00071         <span class="stringliteral">&#39;Fourier transform of Radon Space, Imaginary Part&#39;</span>,...
<a name="l00072"></a>00072         <span class="stringliteral">&#39;theta&#39;</span>,<span class="stringliteral">&#39;omega_s&#39;</span>);     % Save the radon image (imaginary part)
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 stem(fftshift(axis_omega_s), abs(fftshift(Fourier_Radon(:,1))));
<a name="l00075"></a>00075 axis tight;
<a name="l00076"></a>00076 title(<span class="stringliteral">&#39;Slice at angle theta=0 in Fourier Space&#39;</span>)
<a name="l00077"></a>00077 xlabel(&#39;omega_s&#39;),ylabel(&#39;Absolute Value&#39;);             % save the slice at 0deg
<a name="l00078"></a>00078 print -dpng Slice_at_angle_theta_0_in_Fourier_Space.png
<a name="l00079"></a>00079 end
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <a class="code" href="save__image_8m.html#aee6f9621b6888de2610a5cbc82b113e5" title="Save the gray-scale representation of the image.">save_image</a>(THETA, fftshift(axis_omega_s), abs(fftshift(Fourier_Radon,1)),...
<a name="l00082"></a>00082         &#39;Fourier transform of Radon Space, Absolute Value&#39;,...
<a name="l00083"></a>00083         &#39;theta&#39;,&#39;omega_s&#39;);
<a name="l00084"></a>00084 
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Mar 2 2011 22:16:37 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
